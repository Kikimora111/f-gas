<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>F-gas å†å²æ’æ”¾æ•°æ®å¯è§†åŒ–</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <style>
        body { font-family: sans-serif; max-width: 1000px; margin: 0 auto; padding: 20px; }
        h1 { text-align: center; color: #333; }
        #chart-container { width: 100%; height: 600px; margin-top: 20px; border: 1px solid #ddd; }
        .download-btn {
            display: block; width: 200px; margin: 20px auto; padding: 10px;
            text-align: center; background-color: #2ea44f; color: white;
            text-decoration: none; border-radius: 5px; font-weight: bold;
        }
        .download-btn:hover { background-color: #2c974b; }
    </style>
</head>
<body>

    <h1>F-gas ç‰©è´¨å†å²é€å¹´æ’æ”¾é‡</h1>
    <p style="text-align: center;">æ•°æ®æ¥æºï¼šå…¬å¼€æ•°æ®åº“ | æ›´æ–°æ—¶é—´ï¼š2026å¹´</p>

    <div id="chart-container"></div>

    <a href="data.csv" class="download-btn" download="F-gas_Emissions_Data.csv">
        ğŸ“¥ ä¸‹è½½æºæ•°æ® (CSV)
    </a>

    <script>
        // åˆå§‹åŒ–å›¾è¡¨
        var myChart = echarts.init(document.getElementById('chart-container'));

        // æ˜¾ç¤ºâ€œåŠ è½½ä¸­â€æç¤º
        myChart.showLoading();

        // ä½¿ç”¨ PapaParse è¯»å–åŒç›®å½•ä¸‹çš„ data.csv æ–‡ä»¶
        Papa.parse("data.csv", {
            download: true,
            header: true, // è¯†åˆ«ç¬¬ä¸€è¡Œä¸ºæ ‡é¢˜
            dynamicTyping: true, // è‡ªåŠ¨æŠŠå­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—
            complete: function(results) {
                myChart.hideLoading();
                var data = results.data;
                
                // æ•°æ®æ¸…æ´—ï¼šç§»é™¤ç©ºè¡Œ
                data = data.filter(row => row.Year != null);

                // æå–å¹´ä»½ï¼ˆXè½´ï¼‰
                var years = data.map(item => item.Year);

                // è‡ªåŠ¨è·å–æ‰€æœ‰ç‰©è´¨åç§°ï¼ˆé™¤äº†Yearä»¥å¤–çš„æ‰€æœ‰åˆ—åï¼‰
                var substanceNames = results.meta.fields.filter(field => field !== "Year");

                // æ„å»º ECharts éœ€è¦çš„ Series æ•°æ®
                var seriesData = substanceNames.map(name => {
                    return {
                        name: name,
                        type: 'line', // æŠ˜çº¿å›¾
                        smooth: true, // å¹³æ»‘æ›²çº¿
                        data: data.map(item => item[name]),
                        symbol: 'none' // æ•°æ®ç‚¹å¤ªå¤šæ—¶ä¸æ˜¾ç¤ºåœ†ç‚¹ï¼Œé¼ æ ‡æ‚¬åœæ‰æ˜¾ç¤º
                    };
                });

                // é…ç½®å›¾è¡¨é€‰é¡¹
                var option = {
                    tooltip: {
                        trigger: 'axis', // é¼ æ ‡æ‚¬åœæ˜¾ç¤ºç”±äºæ•°æ®
                        order: 'valueDesc' //æŒ‰æ•°å€¼å¤§å°æ’åº
                    },
                    legend: {
                        data: substanceNames, // é¡¶éƒ¨å›¾ä¾‹
                        type: 'scroll', // ç‰©è´¨å¤ªå¤šæ—¶å¯ä»¥æ»šåŠ¨
                        bottom: 0
                    },
                    grid: {
                        left: '3%', right: '4%', bottom: '10%', containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: years,
                        name: 'å¹´ä»½'
                    },
                    yAxis: {
                        type: 'value',
                        name: 'æ’æ”¾é‡ (å¨/CO2e)'
                    },
                    // å…è®¸ç¼©æ”¾æŸ¥çœ‹ç»†èŠ‚
                    dataZoom: [
                        { type: 'inside', start: 0, end: 100 },
                        { type: 'slider', start: 0, end: 100 }
                    ],
                    series: seriesData
                };

                // æ¸²æŸ“å›¾è¡¨
                myChart.setOption(option);
            },
            error: function(err) {
                alert("æ•°æ®è¯»å–å¤±è´¥ï¼Œè¯·æ£€æŸ¥ data.csv æ˜¯å¦å­˜åœ¨");
                console.error(err);
            }
        });

        // çª—å£å¤§å°æ”¹å˜æ—¶è‡ªåŠ¨é‡ç»˜
        window.addEventListener('resize', function() {
            myChart.resize();
        });
    </script>
</body>
</html>
